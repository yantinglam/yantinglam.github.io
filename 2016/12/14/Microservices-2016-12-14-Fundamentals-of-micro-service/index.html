<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Yanting Lam"><meta name="description" content="什么是微服务？&amp;emsp;&amp;emsp;微服务是一种架构风格，在这种架构中，由一个或多个微服务组成一个大型应用或软件。一个微服务代表着一个小的业务功能，各个微服务之间是松耦合的，通过IPC相互通信。单个微服务可以被独立部署。"><meta name="keywords" content="微服务"><title>微服务架构的认识 · Yanting Lam</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://yantinglam.com/2016/12/14/Microservices-2016-12-14-Fundamentals-of-micro-service/"><link rel="alternate" href="/atom.xml" title="Yanting Lam"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?8e7c7417ad2e322a37d13dc7cdc5454e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script><script type="text/javascript">AV.initialize("h9D4obRhn4aqzazLSG9Kxa2k-gzGzoHsz", "pRL4WjJEgaARQXXRWHLXbBgw")</script></head><body><div id="main"><header><a href="/." class="logo">Yanting Lam</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">首页</a></li><li class="nav-link"><a href="/archives/" target="_self">归档</a></li><li class="nav-link"><a href="/tags/" target="_self">标签</a></li><li class="nav-link"><a href="/photography/" target="_self">摄影集</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">微服务架构的认识</h1><p class="post-meta"><span class="post-time">发表于 2016-12-14</span><span id="/2016/12/14/Microservices-2016-12-14-Fundamentals-of-micro-service/" data-flag-title="微服务架构的认识" class="leancloud-visitors"><span class="leancloud-visitors-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span></p><div id="sidebar" class="post-sidebar"><h3 class="heading">目录</h3><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是微服务？"><span class="toc-text">什么是微服务？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#微服务架构与单体式架构应用对比"><span class="toc-text">微服务架构与单体式架构应用对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#微服务架构与SOA架构对比"><span class="toc-text">微服务架构与SOA架构对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要使用微服务架构"><span class="toc-text">为什么要使用微服务架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#微服务的优点"><span class="toc-text">微服务的优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#微服务的缺点"><span class="toc-text">微服务的缺点</span></a></li></ol></li></ol></div><div class="post-content"><h3 id="什么是微服务？"><a href="#什么是微服务？" class="headerlink" title="什么是微服务？"></a>什么是微服务？</h3><p>&emsp;&emsp;微服务是一种架构风格，在这种架构中，由一个或多个微服务组成一个大型应用或软件。一个微服务代表着一个小的业务功能，各个微服务之间是松耦合的，通过<a href="#IPC-explanation" name="IPC">IPC</a>相互通信。单个微服务可以被独立部署。<br><a id="more"></a></p>
<h3 id="微服务架构与单体式架构应用对比"><a href="#微服务架构与单体式架构应用对比" class="headerlink" title="微服务架构与单体式架构应用对比"></a>微服务架构与单体式架构应用对比</h3><table><tr><th></th><th>单体式</th><th>微服务</th><th></th></tr><tr><td>进程安排</td><td>将所有功能都放在一个进程中</td><td>将所有功能拆分为多个业务功能安排到多个服务进程中</td><td rowspan="2"><img src="/images/Microservices/Fundamentals-of-micro-service/Micro-service-and-single-mode-app1.png"></td></tr><tr><td>扩展方式</td><td>通过复制整个应用到多台服务器实现扩展</td><td>通过将不同的服务分布于不同的服务器，并按需复制服务实现扩展</td></tr><tr><td>数据管理</td><td>业务逻辑与数据进行分离，数据一般采用统一设计、统一管理的方式</td><td>将相关联的业务逻辑及数据放在一起形成独立的边界，每个服务管理自有的数据库，每个数据库可以根据该服务的需求有自己的设计</td><td><img src="/images/Microservices/Fundamentals-of-micro-service/Micro-service-and-single-mode-app2.png"></td></tr><tr><td>团队结构</td><td>按功能进行组织，如UI界面设计的一组，数据库的一组，中间件的一组…</td><td>跨功能进行组织，既有UI界面的，也有数据库的，还有中间件的…通常团队不会太大</td><td rowspan="2"><img src="/images/Microservices/Fundamentals-of-micro-service/Micro-service-and-single-mode-app3.png"></td></tr><tr><td>开发及运维方式</td><td>以项目模式开发完整的应用，开发完成后交付给运维团队负责维护</td><td>倡导一个团队负责一个“微服务”的完整生命周期，倡导“谁开发、谁运维”的开发运维一体化</td></tr><tr><td>技术平台</td><td>采用单一的技术平台，如一个单体式应用一般只采用一种编程语言</td><td>鼓励使用合适的工具完成各自的任务，可以选用各自最佳的工具，如不同的编程语言</td><td></td></tr></table>

<p><br></p>
<h3 id="微服务架构与SOA架构对比"><a href="#微服务架构与SOA架构对比" class="headerlink" title="微服务架构与SOA架构对比"></a>微服务架构与<a href="#SOA-explanation" name="SOA">SOA</a>架构对比</h3><table><tr><th></th><th>微服务</th><th>SOA</th></tr><tr><td>相同点</td><td colspan="2"><ul><li>以服务为核心</li><li>强调敏捷及快速推出市场</li></ul></td></tr><tr><td>差异点</td><td><ul><li>强调如何将一个整体的应用拆分成多个可独立部署的服务进程，并通过开放编程语言及数据持久化等措施最大化交付的速度</li><li>强调的“智能端点与管道扁平化”特性与<a href="#ESB-explanation" name="ESB">SOA</a>背道而驰</li><li>利用许多大型组织中应用的新技术与经验，尽可能使用简单的通讯协议如RESTful API</li></ul></td><td><ul><li>SOA内涵广泛，但主要场景包括应用系统的资产重用服务化、通过<a href="#BPM-explanation" name="BPM">BPM</a>实现服务编排，通过ESB实现不同应用的集成</li><li>SOA以Web Service/BPM/ESB等技术为主相对而言显得复杂些</li><li>SOA试图通过ESB隐藏集成的复杂性，却花费巨资而没有体现出价值性</li><li>过度集中管控而抑制了个性化变更</li></ul></td></tr></table>

<p><br></p>
<h3 id="为什么要使用微服务架构"><a href="#为什么要使用微服务架构" class="headerlink" title="为什么要使用微服务架构"></a>为什么要使用微服务架构</h3><h4 id="微服务的优点"><a href="#微服务的优点" class="headerlink" title="微服务的优点"></a>微服务的优点</h4><ul>
<li>微服务架构是松耦合的，每个服务相对比较简单，只关注一个业功能务，可以提供更高的灵活性</li>
<li>微服务架构中的每个服务可由不同的团队独立开发，可根据自身业务选用适用的编程语言与工具进行开发，更能够有针对性地解决问题</li>
<li>每个服务可独立部署，这样可以加快部署，加快推出市场的速度</li>
<li>使用微服务，可以频繁地发布不同服务的同时保持系统其他服务的可用性和稳定性</li>
</ul>
<h4 id="微服务的缺点"><a href="#微服务的缺点" class="headerlink" title="微服务的缺点"></a>微服务的缺点</h4><ul>
<li>进程间通讯机制带来的挑战<p class="li-explanation">&emsp;&emsp;需要在RPC或者消息传递之间选择并完成进程间通讯，需要处理消息传递中速度过慢或者不可用等局部失效问题。</p></li>
<li>分区数据库带来的挑战<p class="li-explanation">&emsp;&emsp;需要更新不同服务所使用的不同数据库，需要处理不同服务之间的数据访问问题。</p></li>
<li>测试难度提高<p class="li-explanation">&emsp;&emsp;测试一个服务需要启动和它有关的所有服务，而且在动态环境下，服务间的交互会产生非常微妙的行为，对于这种行为难以可视化及全面测试。</p></li>
<li>开发及运维成本有所增加<p class="li-explanation">&emsp;&emsp;微服务架构下可能要构建、开发、测试、部署、运行数十个甚至上百个独立的服务，并可能需要支持多种语言和环境，而且开发人员必须要有DevOps开发运维一体化的技能，这些都可能带来成本的增加。</p></li>
<li>代码冗余<p class="li-explanation">&emsp;&emsp;某些底层功能需要被多个服务所用，为了避免“同步耦合引入到系统中”，有时需要向不同的服务添加一些代码，这就会导致代码重复。</p></li>
<li>服务间的协调问题<p class="li-explanation">&emsp;&emsp;把系统分为多个服务组件之后，会产生新的接口，这意味着简单的交叉变化可能需要改变很多组件，比如，假设在一个案例中，需要修改服务A、B、C，而A依赖B，B依赖C，微服务架构模式就需要考虑相关改变对不同服务的影响，就需要更新服务C，然后是B，最后才是A。在实际应用环境中，一个新品发布可能被迫同时发布大量服务，由于集成点的大量增加，微服务架构会有更高的发布风险。</p>

</li>
</ul>
<p>任何事情都有两面性，微服务架构也会有其优缺点，是否需要使用微服务架构，还是要根据项目本身的需求进行考虑。</p>
<p><br><br>注解：<br><a name="IPC-explanation" href="#IPC">IPC：</a>Inter-Process Communication - 进程间通信<br><a name="SOA-explanation" href="#SOA">SOA：</a>Service-Oriented Architecture - 面向服务的体系结构<br><a name="ESB-explanation" href="#ESB">ESB：</a>Enterprise Service Bus - 企业服务总线<br><a name="BPM-explanation" href="#BPM">BPM：</a>Business Process Management - 业务流程管理</p>
<p><br><br>参考链接：<br><a href="https://www.ibm.com/developerworks/community/blogs/3302cc3b-074e-44da-90b1-5055f1dc0d9c/entry/%E8%A7%A3%E6%9E%90%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84_%E4%B8%80_%E4%BB%80%E4%B9%88%E6%98%AF%E5%BE%AE%E6%9C%8D%E5%8A%A1?lang=en" target="_blank" rel="external">解析微服务架构(一)：什么是微服务</a><br><a href="http://dockone.io/article/394" target="_blank" rel="external">微服务实战（一）：微服务架构的优势与不足</a></p>
</div></article><div class="tags"><a href="/tags/微服务/">微服务</a></div><div class="paginator"><a href="/2016/12/15/Microservices-2016-12-15-API-Gateway-of-micro-service/" class="prev"><i class="iconfont icon-left"></i><span> 上一页</span></a><a href="/2016/12/13/Distrubited-2016-12-13-Distributed-cluster/" class="next"><span>下一页</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://yantinglam.com/2016/12/14/Microservices-2016-12-14-Fundamentals-of-micro-service/index.html" data-title="微服务架构的认识" data-url="http://yantinglam.com/2016/12/14/Microservices-2016-12-14-Fundamentals-of-micro-service/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "yantinglam" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="social"><a href="mailto:linyantingly@163.com" title="email" class="iconfont icon-email"></a><a href="https://github.com/yantinglam" title="github" class="iconfont icon-github"></a><a href="/atom.xml" title="rss" class="iconfont icon-rss"></a></div><div class="friendly-links"><h6 class="friendly-links-text">友情链接</h6><a href="http://davidleee.com/" class="friendly-links-url">David Lee(IOS工程师)</a></div><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2017<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Yanting Lam</span></p><p class="calculate"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p></div><div id="back2top"><i class="iconfont icon-up"></i></div></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script><script type="text/javascript">function showPostTime(Counter) {
    var query = new AV.Query(Counter);
    var entries = [];
    var $visitors = $(".leancloud-visitors");

    $visitors.each(function () {
      entries.push( $(this).attr("id").trim() );
    });

    query.containedIn('url', entries);
    query.find()
      .done(function (results) {
        var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

        $visitors.find(COUNT_CONTAINER_REF).text(0);

        for (var i = 0; i < results.length; i++) {
          var item = results[i];
          var url = item.get('url');
          var time = item.get('time');
          var element = document.getElementById(url);

          $(element).find(COUNT_CONTAINER_REF).text(time);
        }
      })
      .fail(function (object, error) {
        console.log("Error: " + error.code + " " + error.message);
      });
  }

  function addPostCount(Counter) {
    var $visitors = $(".leancloud-visitors");
    var url = $visitors.attr('id').trim();
    var title = $visitors.attr('data-flag-title').trim();
    var query = new AV.Query(Counter);

    query.equalTo("url", url);
    query.find({
      success: function(results) {
        if (results.length > 0) {
          var counter = results[0];
          counter.fetchWhenSave(true);
          counter.increment("time");
          counter.save(null, {
            success: function(counter) {
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(counter.get('time'));
            },
            error: function(counter, error) {
              console.log('Failed to save Visitor num, with error message: ' + error.message);
            }
          });
        } else {
          var newcounter = new Counter();
          newcounter.set("title", title);
          newcounter.set("url", url);
          newcounter.set("time", 1);
          newcounter.save(null, {
            success: function(newcounter) {
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
            },
            error: function(newcounter, error) {
              console.log('Failed to create');
            }
          });
        }
      },
      error: function(error) {
        console.log('Error:' + error.code + " " + error.message);
      }
    });
  }

  $(function() {
    var Counter = AV.Object.extend("Counter");
    if ($('.leancloud-visitors').length == 1) {
      addPostCount(Counter);
    } else if ($('.post-link').length > 1) {
      showPostTime(Counter);
    }
  });
</script><script type="text/javascript">function showLikeTime() {
  //- var LikeCounter = AV.Object.extend("LikeCounter");
  var query = new AV.Query("LikeCounter");
  var entries = [];
  var $like = $(".photo-meta");

  $like.each(function () {
    entries.push( $(this).attr("id").trim() );
  });

  query.find()
    .done(function (results) {
      console.log(results);
      var COUNT_CONTAINER_REF = '.like-num';

      $like.find(COUNT_CONTAINER_REF).text(0);

      for (var i = 0; i < results.length; i++) {
        var item = results[i];
        var name = item.get('name');
        var time = item.get('time');
        var element = document.getElementById(name);

        $(element).find(COUNT_CONTAINER_REF).text(time);
      }
    })
    .fail(function (object, error) {
      console.log("Error: " + error.code + " " + error.message);
    });
}

function addLikeCount(name) {
  var LikeCounter = AV.Object.extend("LikeCounter");
  var query = new AV.Query(LikeCounter);

  query.equalTo("name", name);
  query.find({
    success: function(results) {
      console.log(results);
      if (results.length > 0) {
        var counter = results[0];
        counter.fetchWhenSave(true);
        counter.increment("time");
        counter.save(null, {
          success: function(counter) {
            var $element = $(document.getElementById(name));
            $element.find('.like-num').text(counter.get('time'));
          },
          error: function(counter, error) {
            console.log('Failed to save Visitor num, with error message: ' + error.message);
          }
        });
      } else {
        var newcounter = new LikeCounter();
        newcounter.set("name", name);
        newcounter.set("time", 1);
        newcounter.save(null, {
          success: function(newcounter) {
            var $element = $(document.getElementById(name));
            $element.find('.like-num').text(newcounter.get('time'));
          },
          error: function(newcounter, error) {
            console.log('Failed to create');
          }
        });
      }
    },
    error: function(error) {
      console.log('Error:' + error.code + " " + error.message);
    }
  });
}

function deleteLikeCount(name) {
  var LikeCounter = AV.Object.extend("LikeCounter");
  var query = new AV.Query(LikeCounter);

  query.equalTo("name", name);
  query.find({
    success: function(results) {
      console.log(results);
      if (results.length > 0) {
        var counter = results[0];
        counter.fetchWhenSave(true);
        counter.increment("time", -1);
        counter.save(null, {
          success: function(counter) {
            var $element = $(document.getElementById(name));
            $element.find('.like-num').text(counter.get('time'));
          },
          error: function(counter, error) {
            console.log('Failed to save Visitor num, with error message: ' + error.message);
          }
        });
      }
    },
    error: function(error) {
      console.log('Error:' + error.code + " " + error.message);
    }
  });
}


$(".photo-like").click(function() {
    if($(this).hasClass("dislike")) {
        $(this).attr("src", "/images/Photos/like.png").removeClass("dislike").addClass("like");
        addLikeCount($(this).parent().attr("id"));
    } else {
        $(this).attr("src", "/images/Photos/dislike.png").removeClass("like").addClass("dislike");
        deleteLikeCount($(this).parent().attr("id"));
    }
});

$(function() {
  showLikeTime();
})</script></body></html>